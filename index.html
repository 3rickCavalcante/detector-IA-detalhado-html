<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analisador de Texto Acad√™mico - IA vs Humano</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; padding: 20px; 
        }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { text-align: center; color: white; margin-bottom: 40px; }
        .header h1 { font-size: 2.5rem; margin-bottom: 10px; }
        .app-card { 
            background: white; border-radius: 15px; 
            box-shadow: 0 20px 40px rgba(0,0,0,0.1); padding: 40px; 
            margin-bottom: 20px;
        }
        .text-area { 
            width: 100%; min-height: 200px; padding: 20px; 
            border: 2px solid #e2e8f0; border-radius: 10px; 
            font-size: 1rem; resize: vertical; margin-bottom: 20px;
            font-family: monospace; line-height: 1.6;
        }
        .analyze-btn { 
            background: #2563eb; color: white; border: none; 
            padding: 15px 30px; border-radius: 10px; font-size: 1.1rem; 
            cursor: pointer; width: 100%; margin-bottom: 20px;
            transition: all 0.3s ease;
        }
        .analyze-btn:hover { background: #1d4ed8; transform: translateY(-2px); }
        .analyze-btn:disabled { background: #94a3b8; cursor: not-allowed; transform: none; }
        .result { margin-top: 20px; padding: 20px; background: #f8fafc; border-radius: 10px; }
        .stats { background: #e2e8f0; padding: 10px; border-radius: 5px; margin-bottom: 10px; }
        
        .padrao-detectado {
            background-color: #fef3c7;
            border: 1px solid #f59e0b;
            border-radius: 3px;
            padding: 2px 4px;
            margin: 0 1px;
            cursor: help;
            position: relative;
        }
        .padrao-detectado:hover {
            background-color: #fde68a;
            z-index: 1000;
        }
        .padrao-detectado[data-tipo="alto_risco_ia"] { border-color: #dc2626; background-color: #fef2f2; }
        .padrao-detectado[data-tipo="medio_risco_ia"] { border-color: #ea580c; background-color: #fff7ed; }
        .padrao-detectado[data-tipo="forte_humano"] { border-color: #059669; background-color: #ecfdf5; }
        
        .texto-destacado {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            line-height: 1.8;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .metricas {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .metrica-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .metrica-valor {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 5px 0;
        }
        
        .contexto-info {
            background: #fffbeb;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .fator-analise {
            margin: 10px 0;
            padding: 12px;
            border-left: 4px solid #e2e8f0;
            background: #f8fafc;
            border-radius: 5px;
        }

        .fator-positivo {
            border-left-color: #10b981;
            background: #f0fdf4;
        }

        .fator-negativo {
            border-left-color: #ef4444;
            background: #fef2f2;
        }

        .alerta-historico {
            background: #fef3c7;
            border: 2px solid #f59e0b;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîç Analisador de Texto Acad√™mico - IA vs Humano</h1>
            <p>Sistema corrigido com detec√ß√£o hist√≥rica precisa</p>
        </div>
        
        <div class="app-card">
            <div class="contexto-info">
                <strong>üéØ CORRE√á√ÉO APLICADA:</strong> Sistema agora reconhece textos hist√≥ricos 
                (anteriores a 2018) como humanos por padr√£o, com an√°lise focada em padr√µes genu√≠nos de IA moderna.
            </div>

            <h3>üìù Cole seu texto para an√°lise</h3>
            <textarea class="text-area" id="textInput" placeholder="Cole o texto acad√™mico aqui..."></textarea>
            
            <div class="stats" id="textStats">
                Caracteres: 0 | Palavras: 0 | Frases: 0 | Par√°grafos: 0
            </div>
            
            <button class="analyze-btn" id="analyzeBtn">Analisar Texto</button>
            <div id="result"></div>
        </div>
    </div>
    
    <script>
        // ========== SISTEMA CORRIGIDO - DETEC√á√ÉO HIST√ìRICA PRECISA ==========

        // APENAS PADR√ïES GENUINAMENTE MODERNOS DE IA
        const padroesIAGenuinos = {
            'referencias_explicitas_ia': [
                // Apenas refer√™ncias expl√≠citas a tecnologias p√≥s-2018
                'chatgpt', 'gpt-4', 'gpt-3', 'gpt-3.5', 'openai', 'large language model',
                'como um modelo de ia', 'como uma intelig√™ncia artificial', 'assistente de ia',
                'modelo de linguagem grande', 'llm', 'transformers', 'bard', 'claude',
                'copilot', 'github copilot', 'midjourney', 'dall-e', 'stable diffusion'
            ],
            'padroes_tecnicos_modernos': [
                // Termos t√©cnicos que s√≥ fazem sentido para IA moderna
                'tokeniza√ß√£o', 'fine-tuning', 'prompt engineering', 'context window',
                'reinforcement learning from human feedback', 'rlhf', 'chain of thought',
                'few-shot learning', 'zero-shot learning', 'temperature setting',
                'top-p sampling', 'transformer architecture'
            ],
            'comportamentos_estereotipados_modernos': [
                // Padr√µes de comportamento espec√≠ficos de IA conversacional moderna
                'como um assistente de ia', 'fui treinado pela', 'minha base de dados',
                'n√£o tenho experi√™ncias pessoais', 'n√£o possuo emo√ß√µes',
                'como modelo de linguagem', 'minha programa√ß√£o'
            ]
        };

        // PADR√ïES QUE S√ÉO COMUNS EM TEXTOS HUMANOS (ANTIGOS E MODERNOS)
        const padroesHumanosComuns = {
            'expressoes_academicas_tradicionais': [
                '√© importante destacar', 'conv√©m ressaltar', 'considerando os fatores',
                'pode-se inferir', 'observa-se que', 'conclui-se que', 
                'de acordo com', 'verifica-se que', 'cabe salientar',
                '√© pertinente mencionar', 'pressup√µe-se que', 'constata-se que',
                'infere-se que', 'depreende-se que', 'evidencia-se que'
            ],
            'conectivos_academicos': [
                'portanto', 'consequentemente', 'adicionalmente', 'notavelmente',
                'consideravelmente', 'significativamente', 'efetivamente',
                'sobretudo', 'principalmente', 'especialmente'
            ],
            'estruturas_passivas_academicas': [
                '√© realizado', '√© observado', '√© verificado', '√© constatado',
                '√© poss√≠vel identificar', 'pode ser observado', 'deve ser considerado',
                's√£o apresentados', 'foram analisados', 'ser√° discutido'
            ]
        };

        // FORTES INDICADORES DE ESCRITA HUMANA
        const fortesIndicadoresHumanos = {
            'marcadores_autoria_pessoal': [
                'parto do pressuposto', 'acredito que', 'considero que', 'entendo que',
                'na minha opini√£o', 'pela minha experi√™ncia', 'em minha an√°lise',
                'minha pesquisa', 'meu estudo', 'esta investiga√ß√£o', 'neste trabalho',
                'na universidade', 'no departamento', 'na disciplina'
            ],
            'referencias_temporais_historicas': [
                // Refer√™ncias a eventos, anos ou contextos hist√≥ricos
                's√©culo xx', 's√©culo xix', 'd√©cada de', 'anos 90', 'anos 80',
                'mil novecentos', 'revolu√ß√£o industrial', 'guerra mundial',
                'era vitoriana', 'idade m√©dia', 'renascimento'
            ],
            'voz_ativa_pessoal': [
                'analisei', 'pesquisei', 'investiguei', 'constatei', 'verifiquei',
                'demonstrei', 'comprovei', 'identifiquei', 'detectei', 'coletei',
                'entrevistei', 'apliquei', 'desenvolvi'
            ]
        };

        class AnalisadorCorrigido {
            constructor() {
                this.pontuacaoIA = 0;
                this.pontuacaoHumano = 0;
                this.fatores = [];
                this.deteccoes = [];
            }

            analisarTexto(texto) {
                this.reset();
                
                // FATOR 1: Verifica√ß√£o de contexto hist√≥rico
                const contextoHistorico = this.analisarContextoHistorico(texto);
                this.adicionarFator('Contexto Hist√≥rico', contextoHistorico.pontuacao, contextoHistorico.confianca, contextoHistorico.explicacao);
                
                // FATOR 2: Padr√µes genu√≠nos de IA moderna
                const padroesIADetectados = this.detectarPadroesIAGenuinos(texto);
                if (padroesIADetectados.length > 0) {
                    this.adicionarFator('Padr√µes Modernos de IA', 
                        Math.min(1, padroesIADetectados.length * 0.3), 
                        0.95, 
                        `${padroesIADetectados.length} padr√µes genu√≠nos de IA moderna detectados`);
                }

                // FATOR 3: Fortes indicadores humanos
                const indicadoresHumanos = this.detectarIndicadoresHumanosFortes(texto);
                if (indicadoresHumanos.length > 0) {
                    this.adicionarFator('Marcadores de Autoria Humana', 
                        -Math.min(1, indicadoresHumanos.length * 0.4), 
                        0.90, 
                        `${indicadoresHumanos.length} fortes indicadores de escrita humana`);
                }

                // FATOR 4: An√°lise estrutural (conservadora)
                const estrutura = this.analisarEstrutura(texto);
                this.adicionarFator('Diversidade Lexical', 
                    estrutura.diversidade < 0.3 ? 0.2 : 0, 
                    0.7, 
                    `Diversidade: ${Math.round(estrutura.diversidade * 100)}%`);

                // FATOR 5: Coer√™ncia temporal
                const coerenciaTemporal = this.verificarCoerenciaTemporal(texto);
                this.adicionarFator('Coer√™ncia Temporal', 
                    coerenciaTemporal.incoerente ? 0.3 : -0.2, 
                    0.8, 
                    coerenciaTemporal.explicacao);

                return this.calcularResultado();
            }

            analisarContextoHistorico(texto) {
                // Detectar refer√™ncias a anos espec√≠ficos
                const anos = texto.match(/(19[0-9]{2}|20[0-1][0-9])\b/g) || [];
                const anosAntigos = anos.filter(ano => parseInt(ano) < 2018);
                
                if (anosAntigos.length > 0) {
                    return {
                        pontuacao: -0.8,
                        confianca: 0.95,
                        explicacao: `Texto referencia anos hist√≥ricos (${anosAntigos.join(', ')}) - forte indicador humano`
                    };
                }

                // Detectar refer√™ncias a eventos hist√≥ricos
                const eventosHistoricos = [
                    'segunda guerra', 'primeira guerra', 'guerra fria', 'revolu√ß√£o', 
                    'ditadura', 'regime militar', 'constitui√ß√£o de 1988', 'queda do muro',
                    'globaliza√ß√£o', 'neoliberalismo', 'socialismo real'
                ];

                const temReferenciaHistorica = eventosHistoricos.some(evento => 
                    texto.toLowerCase().includes(evento)
                );

                if (temReferenciaHistorica) {
                    return {
                        pontuacao: -0.6,
                        confianca: 0.85,
                        explicacao: 'Refer√™ncias a eventos hist√≥ricos pr√©-IA'
                    };
                }

                return {
                    pontuacao: 0,
                    confianca: 0.5,
                    explicacao: 'Sem refer√™ncias hist√≥ricas expl√≠citas'
                };
            }

            detectarPadroesIAGenuinos(texto) {
                const deteccoes = [];
                const textoLower = texto.toLowerCase();

                Object.entries(padroesIAGenuinos).forEach(([categoria, padroes]) => {
                    padroes.forEach(padrao => {
                        const regex = new RegExp(padrao, 'gi');
                        let match;
                        while ((match = regex.exec(textoLower)) !== null) {
                            deteccoes.push({
                                termo: texto.substring(match.index, match.index + match[0].length),
                                tipo: 'alto_risco_ia',
                                categoria: categoria,
                                justificativa: 'Padr√£o genu√≠no de IA moderna',
                                contexto: this.obterContexto(texto, match.index, match[0].length),
                                posicao: [match.index, match.index + match[0].length]
                            });
                        }
                    });
                });

                return deteccoes;
            }

            detectarIndicadoresHumanosFortes(texto) {
                const deteccoes = [];
                const textoLower = texto.toLowerCase();

                Object.entries(fortesIndicadoresHumanos).forEach(([categoria, padroes]) => {
                    padroes.forEach(padrao => {
                        const regex = new RegExp(padrao, 'gi');
                        let match;
                        while ((match = regex.exec(textoLower)) !== null) {
                            deteccoes.push({
                                termo: texto.substring(match.index, match.index + match[0].length),
                                tipo: 'forte_humano',
                                categoria: categoria,
                                justificativa: 'Forte indicador de autoria humana',
                                contexto: this.obterContexto(texto, match.index, match[0].length),
                                posicao: [match.index, match.index + match[0].length]
                            });
                        }
                    });
                });

                return deteccoes;
            }

            analisarEstrutura(texto) {
                const palavras = texto.match(/\b\w+\b/g) || [];
                const palavrasUnicas = new Set(palavras.map(p => p.toLowerCase()));
                const diversidade = palavrasUnicas.size / palavras.length;

                return {
                    diversidade,
                    totalPalavras: palavras.length
                };
            }

            verificarCoerenciaTemporal(texto) {
                // Verificar contradi√ß√µes temporais (ex: refer√™ncia a ChatGPT em texto de 1999)
                const temIAModerna = Object.values(padroesIAGenuinos).flat().some(padrao => 
                    texto.toLowerCase().includes(padrao)
                );

                const anos = texto.match(/(19[0-9]{2}|20[0-1][0-9])\b/g) || [];
                const anosAntigos = anos.filter(ano => parseInt(ano) < 2018);

                if (temIAModerna && anosAntigos.length > 0) {
                    return {
                        incoerente: true,
                        explicacao: `INCOER√äNCIA: Texto de ${anosAntigos[0]} menciona IA moderna`
                    };
                }

                return {
                    incoerente: false,
                    explicacao: 'Coer√™ncia temporal preservada'
                };
            }

            obterContexto(texto, inicio, comprimento, tamanho = 50) {
                const start = Math.max(0, inicio - tamanho);
                const end = Math.min(texto.length, inicio + comprimento + tamanho);
                return texto.substring(start, end);
            }

            adicionarFator(nome, valor, confianca, explicacao) {
                this.fatores.push({
                    nome,
                    valor: Math.round(valor * 100) / 100,
                    confianca: Math.round(confianca * 100) / 100,
                    explicacao,
                    tipo: valor > 0 ? 'ia' : 'humano'
                });

                if (valor > 0) {
                    this.pontuacaoIA += valor * confianca;
                } else {
                    this.pontuacaoHumano += Math.abs(valor) * confianca;
                }
            }

            calcularResultado() {
                // Base mais conservadora - assume humano at√© prova contr√°ria
                const baseHumano = 0.7;
                const ajusteIA = Math.min(0.25, this.pontuacaoIA);
                const ajusteHumano = Math.min(0.25, this.pontuacaoHumano);

                const probIA = Math.max(0.05, Math.min(0.95, 
                    baseHumano - ajusteHumano + ajusteIA
                ));

                // Confian√ßa baseada na for√ßa das evid√™ncias
                const forcaEvidencias = Math.max(this.pontuacaoIA, this.pontuacaoHumano);
                const confianca = Math.max(0.3, Math.min(0.95, 
                    0.5 + (forcaEvidencias * 0.5)
                ));

                return {
                    probabilidadeIA: Math.round(probIA * 1000) / 1000,
                    probabilidadeHumana: Math.round((1 - probIA) * 1000) / 1000,
                    confianca: Math.round(confianca * 1000) / 1000,
                    fatores: this.fatores,
                    pontuacaoIA: Math.round(this.pontuacaoIA * 100) / 100,
                    pontuacaoHumano: Math.round(this.pontuacaoHumano * 100) / 100
                };
            }

            reset() {
                this.pontuacaoIA = 0;
                this.pontuacaoHumano = 0;
                this.fatores = [];
                this.deteccoes = [];
            }
        }

        function gerarTextoDestacado(texto, deteccoes) {
            if (!deteccoes || deteccoes.length === 0) {
                return texto;
            }
            
            let textoDestacado = texto;
            const deteccoesOrdenadas = [...deteccoes]
                .filter(d => d.posicao[0] !== undefined)
                .sort((a, b) => b.posicao[0] - a.posicao[0]);
            
            deteccoesOrdenadas.forEach(deteccao => {
                const [start, end] = deteccao.posicao;
                const termoOriginal = texto.substring(start, end);
                
                const spanDestacado = `<span class="padrao-detectado" data-tipo="${deteccao.tipo}" title="${deteccao.justificativa}">${termoOriginal}</span>`;
                
                textoDestacado = textoDestacado.substring(0, start) + spanDestacado + textoDestacado.substring(end);
            });
            
            return textoDestacado;
        }

        function analisarTextoCompleto(texto) {
            const analisador = new AnalisadorCorrigido();
            const resultado = analisador.analisarTexto(texto);
            
            // Combinar todas as detec√ß√µes para highlight
            const todasDeteccoes = [
                ...analisador.detectarPadroesIAGenuinos(texto),
                ...analisador.detectarIndicadoresHumanosFortes(texto)
            ];

            return {
                ...resultado,
                textoDestacado: gerarTextoDestacado(texto, todasDeteccoes),
                deteccoes: todasDeteccoes
            };
        }

        function gerarRelatorio(result) {
            const aiProb = Math.round(result.probabilidadeIA * 100);
            const humanProb = Math.round(result.probabilidadeHumana * 100);
            const confidence = Math.round(result.confianca * 100);

            let veredito = 'Escrita Humana Prov√°vel';
            let vereditoColor = '#059669';

            if (aiProb >= 70) {
                veredito = 'Poss√≠vel Uso de IA';
                vereditoColor = '#dc2626';
            } else if (aiProb >= 50) {
                veredito = 'Inconclusivo';
                vereditoColor = '#f59e0b';
            }

            let html = `
                <div style="text-align: center; margin-bottom: 30px; padding: 20px; background: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                    <h3 style="color: ${vereditoColor}; margin-bottom: 15px;">${veredito}</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
                        <div>
                            <div style="font-size: 2em; font-weight: bold; color: #dc2626;">${aiProb}%</div>
                            <div style="color: #6b7280; font-size: 0.9em;">Indicadores de IA</div>
                        </div>
                        <div>
                            <div style="font-size: 2em; font-weight: bold; color: #059669;">${humanProb}%</div>
                            <div style="color: #6b7280; font-size: 0.9em;">Indicadores Humanos</div>
                        </div>
                        <div>
                            <div style="font-size: 2em; font-weight: bold; color: #2563eb;">${confidence}%</div>
                            <div style="color: #6b7280; font-size: 0.9em;">Confiabilidade</div>
                        </div>
                    </div>
                </div>
            `;

            // Alerta hist√≥rico se aplic√°vel
            const fatorHistorico = result.fatores.find(f => f.nome === 'Contexto Hist√≥rico');
            if (fatorHistorico && fatorHistorico.valor < 0) {
                html += `
                    <div class="alerta-historico">
                        <strong>üìú CONTEXTO HIST√ìRICO IDENTIFICADO:</strong><br>
                        ${fatorHistorico.explicacao}. Textos anteriores a 2018 s√£o considerados humanos por padr√£o.
                    </div>
                `;
            }

            // Fatores de an√°lise
            html += `<h4>üìä Fatores de An√°lise:</h4>`;
            result.fatores.forEach(fator => {
                const classe = fator.tipo === 'ia' ? 'fator-negativo' : 'fator-positivo';
                const sinal = fator.valor > 0 ? '+' : '';
                html += `
                    <div class="fator-analise ${classe}">
                        <div style="display: flex; justify-content: between; align-items: center;">
                            <strong>${fator.nome}</strong>
                            <span style="font-weight: bold; color: ${fator.valor > 0 ? '#dc2626' : '#059669'}">
                                ${sinal}${fator.valor}
                            </span>
                        </div>
                        <div style="color: #6b7280; font-size: 0.9em; margin-top: 5px;">
                            ${fator.explicacao} (Confian√ßa: ${Math.round(fator.confianca * 100)}%)
                        </div>
                    </div>
                `;
            });

            // Texto destacado
            if (result.deteccoes.length > 0) {
                html += `
                    <div class="texto-destacado">
                        <h5>üîç Texto com Padr√µes Destacados:</h5>
                        <div>${result.textoDestacado}</div>
                    </div>
                `;
            }

            return html;
        }

        // Event listeners
        document.getElementById('textInput').addEventListener('input', function() {
            const text = this.value;
            const chars = text.length;
            const words = text.trim() ? text.trim().split(/\s+/).length : 0;
            const sentences = text.split(/[.!?]+/).length - 1;
            const paragraphs = text.split(/\n\s*\n/).filter(p => p.trim()).length;
            document.getElementById('textStats').innerHTML = 
                `Caracteres: ${chars} | Palavras: ${words} | Frases: ${sentences} | Par√°grafos: ${paragraphs}`;
        });

        document.getElementById('analyzeBtn').addEventListener('click', function() {
            const text = document.getElementById('textInput').value.trim();
            const resultDiv = document.getElementById('result');
            const button = document.getElementById('analyzeBtn');
            
            if (text.length < 50) {
                resultDiv.innerHTML = '<p style="color: red;">‚ö†Ô∏è Texto muito curto (m√≠nimo 50 caracteres)</p>';
                return;
            }
            
            button.disabled = true;
            button.textContent = 'Analisando...';
            resultDiv.innerHTML = '<p>‚è≥ Executando an√°lise corrigida...</p>';
            
            setTimeout(() => {
                try {
                    const result = analisarTextoCompleto(text);
                    const relatorioHTML = gerarRelatorio(result);
                    
                    resultDiv.innerHTML = relatorioHTML;
                } catch (error) {
                    console.error("Erro:", error);
                    resultDiv.innerHTML = '<p style="color: red;">‚ùå Erro na an√°lise. Tente novamente.</p>';
                } finally {
                    button.disabled = false;
                    button.textContent = 'Analisar Texto';
                }
            }, 1000);
        });

        // Texto de exemplo hist√≥rico
        document.getElementById('textInput').value = `Este estudo, realizado em 1999, analisa os impactos da internet emergente na educa√ß√£o superior. Parto do pressuposto de que as novas tecnologias de comunica√ß√£o, quando adequadamente integradas, podem transformar as pr√°ticas pedag√≥gicas.

Conforme demonstrado pelos dados coletados em 1998 junto a universidades brasileiras, observa-se uma resist√™ncia inicial dos docentes em rela√ß√£o ao uso educacional da world wide web. No entanto, os resultados indicam que aqueles que participaram de programas de capacita√ß√£o mostraram maior abertura √† inova√ß√£o.

Considero que estes achados refor√ßam a import√¢ncia do investimento em desenvolvimento profissional docente, especialmente em um contexto de r√°pidas transforma√ß√µes tecnol√≥gicas.`;

        document.getElementById('textInput').dispatchEvent(new Event('input'));
    </script>
</body>
</html>
