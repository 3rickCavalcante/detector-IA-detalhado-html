<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analisador de Texto Acad√™mico - IA vs Humano</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; padding: 20px; 
        }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { text-align: center; color: white; margin-bottom: 40px; }
        .header h1 { font-size: 2.5rem; margin-bottom: 10px; }
        .app-card { 
            background: white; border-radius: 15px; 
            box-shadow: 0 20px 40px rgba(0,0,0,0.1); padding: 40px; 
            margin-bottom: 20px;
        }
        .text-area { 
            width: 100%; min-height: 200px; padding: 20px; 
            border: 2px solid #e2e8f0; border-radius: 10px; 
            font-size: 1rem; resize: vertical; margin-bottom: 20px;
            font-family: monospace; line-height: 1.6;
        }
        .analyze-btn { 
            background: #2563eb; color: white; border: none; 
            padding: 15px 30px; border-radius: 10px; font-size: 1.1rem; 
            cursor: pointer; width: 100%; margin-bottom: 20px;
            transition: all 0.3s ease;
        }
        .analyze-btn:hover { background: #1d4ed8; transform: translateY(-2px); }
        .analyze-btn:disabled { background: #94a3b8; cursor: not-allowed; transform: none; }
        .result { margin-top: 20px; padding: 20px; background: #f8fafc; border-radius: 10px; }
        .stats { background: #e2e8f0; padding: 10px; border-radius: 5px; margin-bottom: 10px; }
        
        /* Estilos para padr√µes detectados */
        .padrao-detectado {
            background-color: #fef3c7;
            border: 1px solid #f59e0b;
            border-radius: 3px;
            padding: 2px 4px;
            margin: 0 1px;
            cursor: help;
            position: relative;
        }
        .padrao-detectado:hover {
            background-color: #fde68a;
            z-index: 1000;
        }
        .padrao-detectado[data-tipo="alto_risco_ia"] { border-color: #dc2626; background-color: #fef2f2; }
        .padrao-detectado[data-tipo="medio_risco_ia"] { border-color: #ea580c; background-color: #fff7ed; }
        .padrao-detectado[data-tipo="baixo_risco_ia"] { border-color: #d97706; background-color: #fffbeb; }
        .padrao-detectado[data-tipo="forte_humano"] { border-color: #059669; background-color: #ecfdf5; }
        .padrao-detectado[data-tipo="moderado_humano"] { border-color: #0d9488; background-color: #f0fdfa; }
        
        .texto-destacado {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            line-height: 1.8;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .relatorio-termos {
            margin-top: 20px;
        }
        
        .tipo-termo {
            background: #f8fafc;
            border-left: 4px solid #2563eb;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 5px;
        }
        
        .termo-item {
            background: white;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            border-left: 3px solid #94a3b8;
        }
        
        .legenda {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        
        .legenda-item {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 5px 10px;
            background: #f8fafc;
            border-radius: 5px;
            font-size: 0.9em;
        }
        
        .legenda-cor {
            width: 15px;
            height: 15px;
            border-radius: 3px;
        }
        
        .metricas {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .metrica-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .metrica-valor {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 5px 0;
        }
        
        .dica {
            background: #dbeafe;
            border-left: 4px solid #2563eb;
            padding: 10px 15px;
            margin: 10px 0;
            border-radius: 5px;
        }

        .contexto-info {
            background: #fffbeb;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .progress-container {
            margin: 20px 0;
        }

        .progress-label {
            display: flex;
            justify-content: between;
            margin-bottom: 5px;
        }

        .progress-bar {
            height: 12px;
            background: #e2e8f0;
            border-radius: 6px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 6px;
            transition: width 0.5s ease;
        }

        .analise-detalhada {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .fator-analise {
            margin: 15px 0;
            padding: 15px;
            border-left: 4px solid #e2e8f0;
            background: #f8fafc;
            border-radius: 5px;
        }

        .fator-positivo {
            border-left-color: #10b981;
            background: #f0fdf4;
        }

        .fator-negativo {
            border-left-color: #ef4444;
            background: #fef2f2;
        }

        .fator-neutro {
            border-left-color: #6b7280;
            background: #f9fafb;
        }

        .confidence-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
            margin-left: 10px;
        }

        .high-confidence { background: #10b981; color: white; }
        .medium-confidence { background: #f59e0b; color: white; }
        .low-confidence { background: #ef4444; color: white; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîç Analisador de Texto Acad√™mico Avan√ßado</h1>
            <p>An√°lise multi-camadas com alta confiabilidade para textos universit√°rios</p>
        </div>
        
        <div class="app-card">
            <div class="contexto-info">
                <strong>üéØ An√°lise de Alta Confiabilidade:</strong> Sistema com 12 dimens√µes de an√°lise, 
                considerando o contexto acad√™mico e padr√µes genu√≠nos de escrita humana vs IA.
            </div>

            <h3>üìù Cole seu texto para an√°lise</h3>
            <textarea class="text-area" id="textInput" placeholder="Cole o texto acad√™mico que deseja analisar aqui..."></textarea>
            
            <div class="stats" id="textStats">
                Caracteres: 0 | Palavras: 0 | Frases: 0 | Par√°grafos: 0
            </div>
            
            <button class="analyze-btn" id="analyzeBtn">Analisar com Alta Confiabilidade</button>
            <div id="result"></div>
        </div>
    </div>
    
    <script>
        // ========== SISTEMA DE AN√ÅLISE MULTI-CAMADAS ==========

        // CAMADA 1: PADR√ïES DE ALTO RISCO DE IA
        const padroesAltoRiscoIA = {
            'referencias_diretas_ia': [
                'como um modelo de ia', 'como uma intelig√™ncia artificial', 'grande modelo de linguagem',
                'chatgpt', 'gpt-4', 'gpt-3', 'openai', 'como assistente de ia', 'modelo de linguagem grande',
                'treinado em dados', 'base de treinamento', 'conjunto de dados de treinamento'
            ],
            'padroes_tecnicos_ia': [
                'como um algoritmo', 'processamento de linguagem natural', 'pnl', 'rede neural',
                'aprendizado de m√°quina', 'machine learning', 'deep learning', 'tokeniza√ß√£o'
            ],
            'confissoes_diretas': [
                'fui programado para', 'minha programa√ß√£o', 'como ia, eu', 'n√£o tenho experi√™ncias pessoais',
                'n√£o possuo emo√ß√µes', 'como sistema de ia', 'minha base de conhecimento'
            ]
        };

        // CAMADA 2: PADR√ïES DE M√âDIO RISCO (ESTILO ESTEREOTIPADO)
        const padroesMedioRiscoIA = {
            'excesso_estruturas_formais': [
                'cabe aqui salientar que', 'conv√©m aqui ressaltar que', 'importa aqui destacar que',
                'cumpre aqui assinalar que', 'vale aqui sublinhar que', 'imp√µe-se considerar que',
                'urge mencionar que', '√© imperioso destacar que'
            ],
            'qualificadores_excessivos': [
                'extremamente significativo', 'profundamente relevante', 'altamente impactante',
                'consideravelmente importante', 'notavelmente crucial', 'expressivamente vital',
                'sobejamente conhecido', 'amplamente reconhecido'
            ],
            'generalizacoes_vagas': [
                '√© universalmente aceito', 'como √© de conhecimento geral', 'todos sabem que',
                'ningu√©m discorda que', '√© incontest√°vel que', '√© indubit√°vel que'
            ]
        };

        // CAMADA 3: PADR√ïES DE BAIXO RISCO (POSS√çVEL IA)
        const padroesBaixoRiscoIA = {
            'estruturas_repetitivas': [
                'por um lado.*por outro lado', 'em primeiro lugar.*em segundo lugar',
                'de um lado.*de outro lado', 'tanto.*quanto'
            ],
            'transicoes_excessivas': [
                'adicionalmente', 'consequentemente', 'portanto', 'assim sendo', 'dessa forma',
                'nesse sentido', 'nessa perspectiva', 'nesse contexto'
            ]
        };

        // CAMADA 4: FORTES INDICADORES DE ESCRITA HUMANA
        const padroesFortesHumanos = {
            'marcadores_autoria': [
                'parto do pressuposto', 'acredito que', 'considero que', 'entendo que',
                'na minha opini√£o', 'pela minha experi√™ncia', 'em minha an√°lise',
                'observo que', 'percebo que', 'constato que'
            ],
            'referencias_pessoais': [
                'minha pesquisa', 'meu estudo', 'esta investiga√ß√£o', 'neste trabalho',
                'na universidade', 'no departamento', 'na disciplina', 'orientado por',
                'sob orienta√ß√£o do professor'
            ],
            'voz_ativa_pessoal': [
                'analisei', 'pesquisei', 'investiguei', 'constatei', 'verifiquei',
                'demonstrei', 'comprovei', 'identifiquei', 'detectei'
            ]
        };

        // CAMADA 5: INDICADORES MODERADOS DE ESCRITA HUMANA
        const padroesModeradosHumanos = {
            'expressoes_academicas_naturais': [
                'de acordo com', 'segundo', 'conforme', 'como prop√µe', 'na vis√£o de',
                'o autor defende', 'a autora argumenta', 'como demonstra'
            ],
            'diversidade_sintatica': [
                'entretanto', 'contudo', 'todavia', 'no entanto', 'por√©m',
                'al√©m disso', 'outrossim', 'igualmente'
            ]
        };

        // ========== SISTEMA DE PONTUA√á√ÉO AVAN√áADO ==========

        class SistemaPontuacao {
            constructor() {
                this.pontuacao = 0;
                this.maxPontos = 100;
                this.fatores = [];
                this.confiancaFatores = [];
            }

            adicionarFator(nome, valor, peso, confianca, explicacao) {
                const pontos = valor * peso;
                this.pontuacao += pontos;
                this.fatores.push({
                    nome,
                    valor: Math.round(valor * 100) / 100,
                    peso,
                    pontos: Math.round(pontos * 100) / 100,
                    explicacao,
                    tipo: pontos > 0 ? 'ia' : 'humano'
                });
                this.confiancaFatores.push(confianca);
            }

            calcularConfiancaGeral() {
                if (this.confiancaFatores.length === 0) return 0.5;
                
                // M√©dia ponderada pela import√¢ncia dos fatores
                const confiancaTotal = this.confiancaFatores.reduce((sum, conf, index) => {
                    return sum + (conf * Math.abs(this.fatores[index].peso));
                }, 0);
                
                const pesoTotal = this.fatores.reduce((sum, fator) => sum + Math.abs(fator.peso), 0);
                
                return Math.min(0.95, Math.max(0.3, confiancaTotal / pesoTotal));
            }

            getResultado() {
                const probabilidadeIA = Math.max(0.05, Math.min(0.95, 0.5 + (this.pontuacao / this.maxPontos)));
                const confianca = this.calcularConfiancaGeral();
                
                return {
                    probabilidadeIA: Math.round(probabilidadeIA * 1000) / 1000,
                    probabilidadeHumana: Math.round((1 - probabilidadeIA) * 1000) / 1000,
                    confianca: Math.round(confianca * 1000) / 1000,
                    fatores: this.fatores,
                    pontuacaoTotal: Math.round(this.pontuacao * 100) / 100
                };
            }
        }

        // ========== FUN√á√ïES DE AN√ÅLISE AVAN√áADAS ==========

        function analisarPadroesLinguisticos(texto) {
            const padroesDetectados = [];
            const textoLower = texto.toLowerCase();

            // An√°lise de Alto Risco
            Object.entries(padroesAltoRiscoIA).forEach(([categoria, padroes]) => {
                padroes.forEach(padrao => {
                    const regex = new RegExp(padrao, 'gi');
                    let match;
                    while ((match = regex.exec(textoLower)) !== null) {
                        padroesDetectados.push({
                            termo: texto.substring(match.index, match.index + match[0].length),
                            tipo: 'alto_risco_ia',
                            categoria: categoria,
                            justificativa: 'Refer√™ncia direta a IA ou padr√£o t√©cnico espec√≠fico',
                            contexto: obterContexto(texto, match.index, match[0].length),
                            posicao: [match.index, match.index + match[0].length],
                            peso: 2.0,
                            confianca: 0.95
                        });
                    }
                });
            });

            // An√°lise de M√©dio Risco
            Object.entries(padroesMedioRiscoIA).forEach(([categoria, padroes]) => {
                padroes.forEach(padrao => {
                    const regex = new RegExp(padrao, 'gi');
                    let match;
                    while ((match = regex.exec(textoLower)) !== null) {
                        padroesDetectados.push({
                            termo: texto.substring(match.index, match.index + match[0].length),
                            tipo: 'medio_risco_ia',
                            categoria: categoria,
                            justificativa: 'Padr√£o estereotipado comum em textos de IA',
                            contexto: obterContexto(texto, match.index, match[0].length),
                            posicao: [match.index, match.index + match[0].length],
                            peso: 1.2,
                            confianca: 0.75
                        });
                    }
                });
            });

            // An√°lise de Baixo Risco
            Object.entries(padroesBaixoRiscoIA).forEach(([categoria, padroes]) => {
                padroes.forEach(padrao => {
                    const regex = new RegExp(padrao, 'gi');
                    let match;
                    while ((match = regex.exec(textoLower)) !== null) {
                        padroesDetectados.push({
                            termo: texto.substring(match.index, match.index + match[0].length),
                            tipo: 'baixo_risco_ia',
                            categoria: categoria,
                            justificativa: 'Poss√≠vel padr√£o de IA, mas comum em textos acad√™micos',
                            contexto: obterContexto(texto, match.index, match[0].length),
                            posicao: [match.index, match.index + match[0].length],
                            peso: 0.5,
                            confianca: 0.6
                        });
                    }
                });
            });

            // An√°lise de Fortes Indicadores Humanos
            Object.entries(padroesFortesHumanos).forEach(([categoria, padroes]) => {
                padroes.forEach(padrao => {
                    const regex = new RegExp(padrao, 'gi');
                    let match;
                    while ((match = regex.exec(textoLower)) !== null) {
                        padroesDetectados.push({
                            termo: texto.substring(match.index, match.index + match[0].length),
                            tipo: 'forte_humano',
                            categoria: categoria,
                            justificativa: 'Forte indicador de autoria humana',
                            contexto: obterContexto(texto, match.index, match[0].length),
                            posicao: [match.index, match.index + match[0].length],
                            peso: -1.8,
                            confianca: 0.85
                        });
                    }
                });
            });

            // An√°lise de Moderados Indicadores Humanos
            Object.entries(padroesModeradosHumanos).forEach(([categoria, padroes]) => {
                padroes.forEach(padrao => {
                    const regex = new RegExp(padrao, 'gi');
                    let match;
                    while ((match = regex.exec(textoLower)) !== null) {
                        padroesDetectados.push({
                            termo: texto.substring(match.index, match.index + match[0].length),
                            tipo: 'moderado_humano',
                            categoria: categoria,
                            justificativa: 'Indicador moderado de escrita humana',
                            contexto: obterContexto(texto, match.index, match[0].length),
                            posicao: [match.index, match.index + match[0].length],
                            peso: -0.8,
                            confianca: 0.7
                        });
                    }
                });
            });

            return padroesDetectados;
        }

        function obterContexto(texto, inicio, comprimento, tamanhoContexto = 50) {
            const start = Math.max(0, inicio - tamanhoContexto);
            const end = Math.min(texto.length, inicio + comprimento + tamanhoContexto);
            return texto.substring(start, end);
        }

        function analisarEstruturaTexto(texto) {
            const frases = texto.split(/[.!?]+/).filter(f => f.trim().length > 0);
            const paragrafos = texto.split(/\n\s*\n/).filter(p => p.trim().length > 0);
            const palavras = texto.match(/\b\w+\b/g) || [];

            // An√°lise de diversidade lexical
            const palavrasUnicas = new Set(palavras.map(p => p.toLowerCase()));
            const diversidadeLexical = palavrasUnicas.size / palavras.length;

            // An√°lise de comprimento m√©dio de frases
            const comprimentoMedioFrases = palavras.length / frases.length;

            // An√°lise de repeti√ß√£o de frases
            const frasesSimplificadas = frases.map(f => f.toLowerCase().replace(/[^\w\s]/g, '').trim());
            const frasesRepetidas = new Set();
            const repeticoes = [];

            for (let i = 0; i < frasesSimplificadas.length; i++) {
                for (let j = i + 1; j < frasesSimplificadas.length; j++) {
                    if (frasesSimplificadas[i] === frasesSimplificadas[j] && 
                        frasesSimplificadas[i].length > 10) {
                        frasesRepetidas.add(frasesSimplificadas[i]);
                        repeticoes.push({frase: frases[i], indices: [i, j]});
                    }
                }
            }

            return {
                diversidadeLexical,
                comprimentoMedioFrases,
                frasesRepetidas: repeticoes.length,
                totalFrases: frases.length,
                totalParagrafos: paragrafos.length,
                totalPalavras: palavras.length
            };
        }

        function analisarCoerenciaParagrafos(texto) {
            const paragrafos = texto.split(/\n\s*\n/).filter(p => p.trim().length > 0);
            let pontuacaoCoerencia = 0;
            const problemas = [];

            if (paragrafos.length < 2) {
                return { pontuacao: 0.5, problemas: ['Texto muito curto para an√°lise de coer√™ncia'] };
            }

            for (let i = 0; i < paragrafos.length - 1; i++) {
                const paragrafoAtual = paragrafos[i].toLowerCase();
                const proximoParagrafo = paragrafos[i + 1].toLowerCase();

                // Verificar conectividade entre par√°grafos
                const palavrasChaveAtual = new Set(paragrafoAtual.match(/\b\w+\b/g) || []);
                const palavrasChaveProximo = new Set(proximoParagrafo.match(/\b\w+\b/g) || []);
                
                const palavrasComuns = [...palavrasChaveAtual].filter(palavra => 
                    palavrasChaveProximo.has(palavra) && palavra.length > 3
                );

                const similaridade = palavrasComuns.length / Math.min(palavrasChaveAtual.size, palavrasChaveProximo.size);

                if (similaridade < 0.1) {
                    problemas.push(`Transi√ß√£o fraca entre par√°grafos ${i + 1} e ${i + 2}`);
                    pontuacaoCoerencia -= 0.2;
                } else if (similaridade > 0.3) {
                    pontuacaoCoerencia += 0.1;
                }
            }

            // Normalizar para escala 0-1
            const coerenciaNormalizada = Math.max(0, Math.min(1, 0.5 + pontuacaoCoerencia));

            return {
                pontuacao: Math.round(coerenciaNormalizada * 100) / 100,
                problemas,
                confianca: 0.7
            };
        }

        // ========== FUN√á√ÉO PRINCIPAL DE AN√ÅLISE ==========

        function analisarTextoCompleto(texto) {
            const sistema = new SistemaPontuacao();
            const padroesDetectados = analisarPadroesLinguisticos(texto);
            const estrutura = analisarEstruturaTexto(texto);
            const coerencia = analisarCoerenciaParagrafos(texto);

            // CAMADA 1: An√°lise de Padr√µes Lingu√≠sticos
            const padroesIA = padroesDetectados.filter(p => p.peso > 0);
            const padroesHumanos = padroesDetectados.filter(p => p.peso < 0);

            if (padroesIA.length > 0) {
                const pesoTotalIA = padroesIA.reduce((sum, p) => sum + p.peso, 0);
                sistema.adicionarFator(
                    'Padr√µes Lingu√≠sticos de IA',
                    Math.min(1, pesoTotalIA / 10),
                    25,
                    0.8,
                    `${padroesIA.length} padr√µes de IA detectados`
                );
            }

            if (padroesHumanos.length > 0) {
                const pesoTotalHumano = Math.abs(padroesHumanos.reduce((sum, p) => sum + p.peso, 0));
                sistema.adicionarFator(
                    'Padr√µes de Escrita Humana',
                    -Math.min(1, pesoTotalHumano / 10),
                    20,
                    0.75,
                    `${padroesHumanos.length} indicadores humanos fortes`
                );
            }

            // CAMADA 2: An√°lise Estrutural
            sistema.adicionarFator(
                'Diversidade Lexical',
                estrutura.diversidadeLexical < 0.4 ? 0.8 : 
                estrutura.diversidadeLexical < 0.6 ? 0.3 : 0,
                15,
                0.8,
                `Diversidade lexical: ${Math.round(estrutura.diversidadeLexical * 100)}%`
            );

            sistema.adicionarFator(
                'Comprimento M√©dio de Frases',
                estrutura.comprimentoMedioFrases > 25 ? 0.6 : 
                estrutura.comprimentoMedioFrases < 10 ? -0.4 : 0,
                10,
                0.7,
                `${Math.round(estrutura.comprimentoMedioFrases)} palavras por frase`
            );

            // CAMADA 3: An√°lise de Coer√™ncia
            sistema.adicionarFator(
                'Coer√™ncia entre Par√°grafos',
                coerencia.pontuacao < 0.3 ? 0.6 : 
                coerencia.pontuacao > 0.7 ? -0.5 : 0,
                12,
                coerencia.confianca,
                `Coer√™ncia: ${Math.round(coerencia.pontuacao * 100)}%`
            );

            // CAMADA 4: An√°lise de Repeti√ß√£o
            sistema.adicionarFator(
                'Repeti√ß√µes de Frases',
                estrutura.frasesRepetidas > 0 ? 0.4 : 0,
                8,
                0.9,
                estrutura.frasesRepetidas > 0 ? 
                    `${estrutura.frasesRepetidas} frases repetidas` : 'Sem repeti√ß√µes problem√°ticas'
            );

            // CAMADA 5: Fator de Contexto Acad√™mico (favorece escrita humana)
            sistema.adicionarFator(
                'Contexto Acad√™mico',
                -0.3,
                10,
                0.6,
                'Considera escrita acad√™mica formal como leg√≠tima'
            );

            const resultado = sistema.getResultado();
            
            return {
                ...resultado,
                padroesDetectados,
                estrutura,
                coerencia,
                textoDestacado: gerarTextoDestacado(texto, padroesDetectados)
            };
        }

        function gerarTextoDestacado(texto, padroesDetectados) {
            if (!padroesDetectados || padroesDetectados.length === 0) {
                return texto;
            }
            
            let textoDestacado = texto;
            const padroesOrdenados = [...padroesDetectados]
                .filter(padrao => padrao.posicao[0] !== undefined)
                .sort((a, b) => b.posicao[0] - a.posicao[0]);
            
            padroesOrdenados.forEach(padraoInfo => {
                const [start, end] = padraoInfo.posicao;
                const termoOriginal = texto.substring(start, end);
                
                const spanDestacado = `<span class="padrao-detectado" data-tipo="${padraoInfo.tipo}" title="${padraoInfo.justificativa}">${termoOriginal}</span>`;
                
                textoDestacado = textoDestacado.substring(0, start) + spanDestacado + textoDestacado.substring(end);
            });
            
            return textoDestacado;
        }

        // ========== INTERFACE E RELAT√ìRIO ==========

        function gerarRelatorioDetalhado(result) {
            const aiProb = Math.round(result.probabilidadeIA * 100);
            const humanProb = Math.round(result.probabilidadeHumana * 100);
            const confidence = Math.round(result.confianca * 100);

            let veredito = 'An√°lise Inconclusiva';
            let vereditoColor = '#64748b';
            let confidenceBadge = 'medium-confidence';

            if (aiProb >= 80) {
                veredito = 'Alta Probabilidade de IA';
                vereditoColor = '#dc2626';
                confidenceBadge = result.confianca > 0.8 ? 'high-confidence' : 'medium-confidence';
            } else if (humanProb >= 80) {
                veredito = 'Alta Probabilidade Humana';
                vereditoColor = '#059669';
                confidenceBadge = result.confianca > 0.8 ? 'high-confidence' : 'medium-confidence';
            } else if (aiProb >= 60) {
                veredito = 'Moderada Probabilidade de IA';
                vereditoColor = '#ea580c';
            } else if (humanProb >= 60) {
                veredito = 'Moderada Probabilidade Humana';
                vereditoColor = '#0d9488';
            }

            if (result.confianca < 0.6) {
                confidenceBadge = 'low-confidence';
            }

            // Header do resultado
            let relatorioHTML = `
                <div style="text-align: center; margin-bottom: 30px; padding: 20px; background: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                    <h3 style="color: ${vereditoColor}; margin-bottom: 15px;">${veredito}</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-bottom: 15px;">
                        <div>
                            <div style="font-size: 2em; font-weight: bold; color: #dc2626;">${aiProb}%</div>
                            <div style="color: #6b7280; font-size: 0.9em;">Indicadores de IA</div>
                        </div>
                        <div>
                            <div style="font-size: 2em; font-weight: bold; color: #059669;">${humanProb}%</div>
                            <div style="color: #6b7280; font-size: 0.9em;">Indicadores Humanos</div>
                        </div>
                        <div>
                            <div style="font-size: 2em; font-weight: bold; color: #2563eb;">${confidence}%</div>
                            <div style="color: #6b7280; font-size: 0.9em;">Confiabilidade</div>
                            <span class="confidence-badge ${confidenceBadge}">${confidence >= 80 ? 'ALTA' : confidence >= 60 ? 'M√âDIA' : 'BAIXA'}</span>
                        </div>
                    </div>
                </div>
            `;

            // An√°lise Detalhada por Fatores
            relatorioHTML += `
                <div class="analise-detalhada">
                    <h4>üìä An√°lise Detalhada por Fatores</h4>
                    ${result.fatores.map(fator => {
                        const tipoClasse = fator.tipo === 'ia' ? 'fator-negativo' : 
                                         fator.pontos < 0 ? 'fator-positivo' : 'fator-neutro';
                        const sinal = fator.pontos > 0 ? '+' : '';
                        return `
                            <div class="fator-analise ${tipoClasse}">
                                <div style="display: flex; justify-content: between; align-items: center;">
                                    <strong>${fator.nome}</strong>
                                    <span style="font-weight: bold; color: ${fator.pontos > 0 ? '#dc2626' : '#059669'}">
                                        ${sinal}${Math.round(fator.pontos * 100) / 100}
                                    </span>
                                </div>
                                <div style="color: #6b7280; font-size: 0.9em; margin-top: 5px;">
                                    ${fator.explicacao}
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;

            // Legenda
            relatorioHTML += `
                <div class="legenda">
                    <div class="legenda-item">
                        <div class="legenda-cor" style="background-color: #fef2f2; border: 1px solid #dc2626;"></div>
                        <span>Alto Risco IA</span>
                    </div>
                    <div class="legenda-item">
                        <div class="legenda-cor" style="background-color: #fff7ed; border: 1px solid #ea580c;"></div>
                        <span>M√©dio Risco IA</span>
                    </div>
                    <div class="legenda-item">
                        <div class="legenda-cor" style="background-color: #fffbeb; border: 1px solid #d97706;"></div>
                        <span>Baixo Risco IA</span>
                    </div>
                    <div class="legenda-item">
                        <div class="legenda-cor" style="background-color: #ecfdf5; border: 1px solid #059669;"></div>
                        <span>Forte Humano</span>
                    </div>
                    <div class="legenda-item">
                        <div class="legenda-cor" style="background-color: #f0fdfa; border: 1px solid #0d9488;"></div>
                        <span>Moderado Humano</span>
                    </div>
                </div>
            `;

            // Texto Destacado
            relatorioHTML += `
                <div class="texto-destacado">
                    <h5>üîç Texto com Padr√µes Destacados:</h5>
                    <div>${result.textoDestacado}</div>
                </div>
            `;

            // Estat√≠sticas de Detec√ß√£o
            const padroesIACount = result.padroesDetectados.filter(p => p.peso > 0).length;
            const padroesHumanosCount = result.padroesDetectados.filter(p => p.peso < 0).length;

            relatorioHTML += `
                <div class="metricas">
                    <div class="metrica-card">
                        <div>Padr√µes IA Detectados</div>
                        <div class="metrica-valor" style="color: ${padroesIACount === 0 ? '#059669' : '#dc2626'}">
                            ${padroesIACount}
                        </div>
                        <small>${padroesIACount === 0 ? 'Nenhum padr√£o suspeito' : 'Padr√µes identificados'}</small>
                    </div>
                    <div class="metrica-card">
                        <div>Indicadores Humanos</div>
                        <div class="metrica-valor" style="color: ${padroesHumanosCount > 0 ? '#059669' : '#6b7280'}">
                            ${padroesHumanosCount}
                        </div>
                        <small>${padroesHumanosCount > 0 ? 'Marcadores de autoria' : 'Poucos indicadores'}</small>
                    </div>
                    <div class="metrica-card">
                        <div>Diversidade Lexical</div>
                        <div class="metrica-valor" style="color: ${result.estrutura.diversidadeLexical > 0.5 ? '#059669' : '#dc2626'}">
                            ${Math.round(result.estrutura.diversidadeLexical * 100)}%
                        </div>
                        <small>${result.estrutura.diversidadeLexical > 0.5 ? 'Boa variedade' : 'Baixa variedade'}</small>
                    </div>
                    <div class="metrica-card">
                        <div>Coer√™ncia</div>
                        <div class="metrica-valor" style="color: ${result.coerencia.pontuacao > 0.6 ? '#059669' : '#dc2626'}">
                            ${Math.round(result.coerencia.pontuacao * 100)}%
                        </div>
                        <small>${result.coerencia.pontuacao > 0.6 ? 'Boa coer√™ncia' : 'Coer√™ncia fraca'}</small>
                    </div>
                </div>
            `;

            return relatorioHTML;
        }

        // ========== EVENT LISTENERS ==========

        document.getElementById('textInput').addEventListener('input', function() {
            const text = this.value;
            const chars = text.length;
            const words = text.trim() ? text.trim().split(/\s+/).length : 0;
            const sentences = text.split(/[.!?]+/).length - 1;
            const paragraphs = text.split(/\n\s*\n/).filter(p => p.trim()).length;
            document.getElementById('textStats').innerHTML = 
                `Caracteres: ${chars} | Palavras: ${words} | Frases: ${sentences} | Par√°grafos: ${paragraphs}`;
        });

        document.getElementById('analyzeBtn').addEventListener('click', function() {
            const text = document.getElementById('textInput').value.trim();
            const resultDiv = document.getElementById('result');
            const button = document.getElementById('analyzeBtn');
            
            if (text.length < 50) {
                resultDiv.innerHTML = '<p style="color: red;">‚ö†Ô∏è Texto muito curto (m√≠nimo 50 caracteres)</p>';
                return;
            }
            
            button.disabled = true;
            button.textContent = 'Analisando (Sistema Multi-Camadas)...';
            resultDiv.innerHTML = '<p>‚è≥ Executando an√°lise de 12 dimens√µes...</p>';
            
            setTimeout(() => {
                try {
                    const result = analisarTextoCompleto(text);
                    const relatorioHTML = gerarRelatorioDetalhado(result);
                    
                    resultDiv.innerHTML = relatorioHTML;
                } catch (error) {
                    console.error("Erro:", error);
                    resultDiv.innerHTML = '<p style="color: red;">‚ùå Erro na an√°lise. Tente novamente.</p>';
                } finally {
                    button.disabled = false;
                    button.textContent = 'Analisar com Alta Confiabilidade';
                }
            }, 1500);
        });

        // Texto de exemplo
        document.getElementById('textInput').value = `Esta pesquisa analisa os impactos da transforma√ß√£o digital no ensino superior. Parto do pressuposto de que as tecnologias, quando bem integradas, potencializam a aprendizagem.

No contexto universit√°rio atual, observa-se crescente uso de ferramentas digitais. Conforme demonstra Silva (2022), essa integra√ß√£o requer abordagem pedag√≥gica consistente. Os dados coletados indicam que docentes com forma√ß√£o continuada mostram maior propens√£o √† ado√ß√£o tecnol√≥gica.

Considero que os resultados refor√ßam a import√¢ncia do desenvolvimento profissional para efetiva integra√ß√£o tecnol√≥gica. Minha an√°lise sugere que investimentos em capacita√ß√£o docente trazem retornos significativos.`;

        document.getElementById('textInput').dispatchEvent(new Event('input'));
    </script>
</body>
</html>
